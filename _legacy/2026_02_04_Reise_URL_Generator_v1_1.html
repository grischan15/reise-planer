<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reise-Recherche URL Generator</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        h1 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        
        .section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            margin-top: 0;
            color: #007bff;
            font-size: 1.2em;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #007bff;
        }
        
        .help-text {
            font-size: 12px;
            color: #888;
            margin-top: 4px;
        }
        
        .calculated {
            background: #e8f4ff;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
        }
        
        .calculated h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #007bff;
        }
        
        .calculated-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .calculated-item {
            background: white;
            padding: 8px 12px;
            border-radius: 4px;
        }
        
        .calculated-item strong {
            color: #333;
        }
        
        button {
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #333;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .url-list {
            margin-top: 20px;
        }
        
        .url-item {
            background: #f8f9fa;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
            border-left: 4px solid #007bff;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 10px;
        }
        
        .url-item.flight { border-left-color: #007bff; }
        .url-item.accommodation { border-left-color: #28a745; }
        .url-item.car { border-left-color: #ffc107; }
        .url-item.info { border-left-color: #dc3545; }
        
        .url-content {
            flex: 1;
            min-width: 0;
        }
        
        .url-item h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
        }
        
        .url-item a {
            word-break: break-all;
            color: #007bff;
            font-size: 12px;
        }
        
        .url-item .btn-open {
            padding: 6px 12px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #0dcaf0;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        #output {
            display: none;
        }
        
        #output.visible {
            display: block;
        }
        
        .tab-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        
        .tab-status.visible {
            display: block;
        }
        
        .tab-status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
        }
        
        .tab-status.warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
        }
        
        .manual-links {
            margin-top: 15px;
            padding: 15px;
            background: #e8f4ff;
            border-radius: 4px;
        }
        
        .manual-links h4 {
            margin: 0 0 10px 0;
            color: #007bff;
        }
        
        .manual-links a {
            display: inline-block;
            margin: 5px 10px 5px 0;
            padding: 8px 16px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .manual-links a:hover {
            background: #0056b3;
        }
        
        .manual-links a.green { background: #28a745; }
        .manual-links a.green:hover { background: #1e7e34; }
        .manual-links a.yellow { background: #ffc107; color: #333; }
        .manual-links a.yellow:hover { background: #e0a800; }
        .manual-links a.red { background: #dc3545; }
        .manual-links a.red:hover { background: #c82333; }
    </style>
</head>
<body>
    <h1>üåç Reise-Recherche URL Generator</h1>
    
    <div class="section">
        <h2>1. Reisezeitraum</h2>
        <div class="form-row">
            <div class="form-group">
                <label for="dateFrom">Fr√ºhester Hinflug</label>
                <input type="date" id="dateFrom" required>
                <div class="help-text">Ab wann kannst du fr√ºhestens fliegen?</div>
            </div>
            <div class="form-group">
                <label for="dateTo">Sp√§tester R√ºckflug</label>
                <input type="date" id="dateTo" required>
                <div class="help-text">Bis wann musst du sp√§testens zur√ºck sein?</div>
            </div>
            <div class="form-group">
                <label for="flex">Flexibilit√§t (Tage)</label>
                <select id="flex">
                    <option value="1">¬±1 Tag</option>
                    <option value="2">¬±2 Tage</option>
                    <option value="3" selected>¬±3 Tage</option>
                    <option value="4">¬±4 Tage</option>
                </select>
                <div class="help-text">Standard: 3 Tage</div>
            </div>
        </div>
        
        <div class="calculated" id="dateCalculation" style="display:none;">
            <h3>üìÖ Berechnete Suchdaten</h3>
            <div class="calculated-grid">
                <div class="calculated-item">
                    <strong>Kiwi Hinflug:</strong> <span id="calcKiwiHin">-</span>
                </div>
                <div class="calculated-item">
                    <strong>Kiwi R√ºckflug:</strong> <span id="calcKiwiRueck">-</span>
                </div>
                <div class="calculated-item">
                    <strong>Unterkunft Check-in:</strong> <span id="calcCheckin">-</span>
                </div>
                <div class="calculated-item">
                    <strong>Unterkunft Check-out:</strong> <span id="calcCheckout">-</span>
                </div>
                <div class="calculated-item">
                    <strong>Reisetage (max):</strong> <span id="calcDays">-</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>2. Reiseziel</h2>
        <div class="form-row">
            <div class="form-group">
                <label for="destination">Ziel ausw√§hlen</label>
                <select id="destination">
                    <option value="">-- Bitte w√§hlen --</option>
                    <option value="antalya">Antalya, T√ºrkei</option>
                    <option value="marrakesch">Marrakesch, Marokko</option>
                    <option value="agadir">Agadir, Marokko</option>
                    <option value="banjul">Banjul, Gambia</option>
                    <option value="sal">Sal, Kap Verde</option>
                    <option value="larnaka">Larnaka, Zypern</option>
                    <option value="paphos">Paphos, Zypern</option>
                    <option value="tirana">Tirana, Albanien</option>
                    <option value="palma">Palma, Mallorca</option>
                    <option value="faro">Faro, Portugal</option>
                    <option value="malaga">Malaga, Spanien</option>
                    <option value="hurghada">Hurghada, √Ñgypten</option>
                    <option value="sharm">Sharm el Sheikh, √Ñgypten</option>
                    <option value="tunis">Tunis, Tunesien</option>
                    <option value="djerba">Djerba, Tunesien</option>
                </select>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>3. Reisende & Gep√§ck</h2>
        <div class="form-row">
            <div class="form-group">
                <label for="adults">Anzahl Erwachsene</label>
                <select id="adults">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3" selected>3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </div>
            <div class="form-group">
                <label for="bedrooms">Schlafzimmer (min)</label>
                <select id="bedrooms">
                    <option value="1">1</option>
                    <option value="2" selected>2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>
            <div class="form-group">
                <label for="checkedBags">Aufgabegep√§ck (Anzahl)</label>
                <select id="checkedBags">
                    <option value="0">0 (nur Handgep√§ck)</option>
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>4. Abflughafen</h2>
        <div class="form-row">
            <div class="form-group">
                <label for="departureCity">Abflug-Zentrum</label>
                <select id="departureCity">
                    <option value="frankfurt-am-main">Frankfurt am Main</option>
                    <option value="muenchen">M√ºnchen</option>
                    <option value="berlin">Berlin</option>
                    <option value="koeln">K√∂ln</option>
                    <option value="duesseldorf">D√ºsseldorf</option>
                    <option value="stuttgart">Stuttgart</option>
                </select>
            </div>
            <div class="form-group">
                <label for="radius">Radius (km)</label>
                <select id="radius">
                    <option value="300">300 km</option>
                    <option value="400">400 km</option>
                    <option value="500" selected>500 km</option>
                    <option value="600">600 km</option>
                </select>
            </div>
            <div class="form-group">
                <label for="driverAge">Fahrer-Alter (Mietwagen)</label>
                <input type="number" id="driverAge" value="35" min="18" max="99">
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>5. Aktionen</h2>
        
        <button class="btn-primary" onclick="generateURLs()">üîç URLs Generieren</button>
        <button class="btn-success" onclick="openAllTabs()" id="btnOpenTabs" disabled>üöÄ Alle Tabs √ñffnen (6 St√ºck)</button>
        <button class="btn-secondary" onclick="copyAllURLs()" id="btnCopy" disabled>üìã URLs Kopieren</button>
        
        <div class="tab-status" id="tabStatus"></div>
    </div>
    
    <div class="section" id="output">
        <h2>6. Generierte URLs</h2>
        
        <div class="info" id="summaryInfo"></div>
        
        <!-- Manuelle Klick-Links als Fallback -->
        <div class="manual-links" id="manualLinks">
            <h4>üñ±Ô∏è Klicke einzeln zum √ñffnen:</h4>
            <div id="linkButtons"></div>
        </div>
        
        <div class="url-list" id="urlList"></div>
    </div>

    <script>
        // Ziel-Datenbank
        const destinations = {
            antalya: {
                name: "Antalya",
                country: "T√ºrkei",
                countryDE: "T√ºrkei",
                kiwiSlug: "antalya-turkei",
                airbnbFormat: "Antalya--T%C3%BCrkei",
                bookingFormat: "Antalya%2C+T%C3%BCrkei",
                lat: 36.8969,
                lon: 30.7133
            },
            marrakesch: {
                name: "Marrakesch",
                country: "Marokko",
                countryDE: "Marokko",
                kiwiSlug: "marrakesch-marokko",
                airbnbFormat: "Marrakesch--Marokko",
                bookingFormat: "Marrakesch%2C+Marokko",
                lat: 31.6295,
                lon: -7.9811
            },
            agadir: {
                name: "Agadir",
                country: "Marokko",
                countryDE: "Marokko",
                kiwiSlug: "agadir-marokko",
                airbnbFormat: "Agadir--Marokko",
                bookingFormat: "Agadir%2C+Marokko",
                lat: 30.4278,
                lon: -9.5981
            },
            banjul: {
                name: "Banjul",
                country: "Gambia",
                countryDE: "Gambia",
                kiwiSlug: "banjul-gambia",
                airbnbFormat: "Banjul--Gambia",
                bookingFormat: "Banjul%2C+Gambia",
                lat: 13.4549,
                lon: -16.5790
            },
            sal: {
                name: "Sal",
                country: "Kap Verde",
                countryDE: "Kap Verde",
                kiwiSlug: "sal-kap-verde",
                airbnbFormat: "Sal--Kap-Verde",
                bookingFormat: "Sal%2C+Kap+Verde",
                lat: 16.7356,
                lon: -22.9435
            },
            larnaka: {
                name: "Larnaka",
                country: "Zypern",
                countryDE: "Zypern",
                kiwiSlug: "larnaka-zypern",
                airbnbFormat: "Larnaka--Zypern",
                bookingFormat: "Larnaka%2C+Zypern",
                lat: 34.9229,
                lon: 33.6232
            },
            paphos: {
                name: "Paphos",
                country: "Zypern",
                countryDE: "Zypern",
                kiwiSlug: "paphos-zypern",
                airbnbFormat: "Paphos--Zypern",
                bookingFormat: "Paphos%2C+Zypern",
                lat: 34.7754,
                lon: 32.4245
            },
            tirana: {
                name: "Tirana",
                country: "Albanien",
                countryDE: "Albanien",
                kiwiSlug: "tirana-albanien",
                airbnbFormat: "Tirana--Albanien",
                bookingFormat: "Tirana%2C+Albanien",
                lat: 41.3275,
                lon: 19.8187
            },
            palma: {
                name: "Palma",
                country: "Spanien",
                countryDE: "Spanien",
                kiwiSlug: "palma-spanien",
                airbnbFormat: "Palma--Spanien",
                bookingFormat: "Palma%2C+Spanien",
                lat: 39.5696,
                lon: 2.6502
            },
            faro: {
                name: "Faro",
                country: "Portugal",
                countryDE: "Portugal",
                kiwiSlug: "faro-portugal",
                airbnbFormat: "Faro--Portugal",
                bookingFormat: "Faro%2C+Portugal",
                lat: 37.0194,
                lon: -7.9322
            },
            malaga: {
                name: "Malaga",
                country: "Spanien",
                countryDE: "Spanien",
                kiwiSlug: "malaga-spanien",
                airbnbFormat: "Malaga--Spanien",
                bookingFormat: "Malaga%2C+Spanien",
                lat: 36.6749,
                lon: -4.4991
            },
            hurghada: {
                name: "Hurghada",
                country: "√Ñgypten",
                countryDE: "√Ñgypten",
                kiwiSlug: "hurghada-agypten",
                airbnbFormat: "Hurghada--%C3%84gypten",
                bookingFormat: "Hurghada%2C+%C3%84gypten",
                lat: 27.2579,
                lon: 33.8116
            },
            sharm: {
                name: "Sharm el Sheikh",
                country: "√Ñgypten",
                countryDE: "√Ñgypten",
                kiwiSlug: "sharm-el-sheikh-agypten",
                airbnbFormat: "Sharm-El-Sheikh--%C3%84gypten",
                bookingFormat: "Sharm+el+Sheikh%2C+%C3%84gypten",
                lat: 27.9158,
                lon: 34.3300
            },
            tunis: {
                name: "Tunis",
                country: "Tunesien",
                countryDE: "Tunesien",
                kiwiSlug: "tunis-tunesien",
                airbnbFormat: "Tunis--Tunesien",
                bookingFormat: "Tunis%2C+Tunesien",
                lat: 36.8065,
                lon: 10.1815
            },
            djerba: {
                name: "Djerba",
                country: "Tunesien",
                countryDE: "Tunesien",
                kiwiSlug: "djerba-tunesien",
                airbnbFormat: "Djerba--Tunesien",
                bookingFormat: "Djerba%2C+Tunesien",
                lat: 33.8076,
                lon: 10.8451
            }
        };

        let generatedURLs = [];

        // Datum-Hilfsfunktionen
        function addDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + days);
            return result;
        }

        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function formatDateDE(date) {
            return date.toLocaleDateString('de-DE');
        }

        // Gep√§ck-String generieren
        function generateBagsString(adults, checkedBags) {
            let bags = [];
            for (let i = 0; i < adults; i++) {
                if (i < checkedBags) {
                    bags.push('1.1');
                } else {
                    bags.push('1.0');
                }
            }
            return bags.join('_') + '-';
        }

        // Datumsberechnung bei √Ñnderung
        document.getElementById('dateFrom').addEventListener('change', updateDateCalculation);
        document.getElementById('dateTo').addEventListener('change', updateDateCalculation);
        document.getElementById('flex').addEventListener('change', updateDateCalculation);

        function updateDateCalculation() {
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            const flex = parseInt(document.getElementById('flex').value);

            if (dateFrom && dateTo) {
                const fromDate = new Date(dateFrom);
                const toDate = new Date(dateTo);
                
                const kiwiHin = addDays(fromDate, flex);
                const kiwiRueck = addDays(toDate, -flex);
                
                const days = Math.ceil((toDate - fromDate) / (1000 * 60 * 60 * 24));

                document.getElementById('calcKiwiHin').textContent = formatDateDE(kiwiHin) + ` (flex${flex})`;
                document.getElementById('calcKiwiRueck').textContent = formatDateDE(kiwiRueck) + ` (flex${flex})`;
                document.getElementById('calcCheckin').textContent = formatDateDE(fromDate);
                document.getElementById('calcCheckout').textContent = formatDateDE(toDate);
                document.getElementById('calcDays').textContent = days + ' Tage';

                document.getElementById('dateCalculation').style.display = 'block';
            }
        }

        // URLs generieren
        function generateURLs() {
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            const flex = parseInt(document.getElementById('flex').value);
            const destKey = document.getElementById('destination').value;
            const adults = document.getElementById('adults').value;
            const bedrooms = document.getElementById('bedrooms').value;
            const checkedBags = parseInt(document.getElementById('checkedBags').value);
            const departureCity = document.getElementById('departureCity').value;
            const radius = document.getElementById('radius').value;
            const driverAge = document.getElementById('driverAge').value;

            // Validierung
            if (!dateFrom || !dateTo) {
                alert('Bitte Reisezeitraum eingeben!');
                return;
            }
            if (!destKey) {
                alert('Bitte Reiseziel ausw√§hlen!');
                return;
            }

            const dest = destinations[destKey];
            const fromDate = new Date(dateFrom);
            const toDate = new Date(dateTo);
            
            // Kiwi-Daten berechnen
            const kiwiHin = formatDate(addDays(fromDate, flex));
            const kiwiRueck = formatDate(addDays(toDate, -flex));
            
            // Unterkunft/Mietwagen-Daten
            const checkin = formatDate(fromDate);
            const checkout = formatDate(toDate);
            
            // Gep√§ck-String
            const bagsString = generateBagsString(parseInt(adults), checkedBags);

            // URLs generieren
            generatedURLs = [];

            // 1. Kiwi Flug
            const kiwiURL = `https://www.kiwi.com/de/search/results/${departureCity}-deutschland-${radius}km/${dest.kiwiSlug}/${kiwiHin}_flex${flex}/${kiwiRueck}_flex${flex}/?returnToDifferentAirport=false&adults=${adults}&children=0&infants=0&bags=${bagsString}`;
            generatedURLs.push({
                type: 'flight',
                name: '‚úàÔ∏è Kiwi.com - Fl√ºge',
                shortName: 'Fl√ºge',
                url: kiwiURL,
                colorClass: ''
            });

            // 2. Booking.com
            const bookingURL = `https://www.booking.com/searchresults.de.html?ss=${dest.bookingFormat}&checkin=${checkin}&checkout=${checkout}&group_adults=${adults}&no_rooms=${bedrooms}&nflt=ht_id%3D201%3Bentire_place_bedroom_count%3D${bedrooms}`;
            generatedURLs.push({
                type: 'accommodation',
                name: 'üè® Booking.com - Apartments',
                shortName: 'Booking',
                url: bookingURL,
                colorClass: 'green'
            });

            // 3. Airbnb
            const airbnbURL = `https://www.airbnb.de/s/${dest.airbnbFormat}/homes?checkin=${checkin}&checkout=${checkout}&adults=${adults}&min_bedrooms=${bedrooms}`;
            generatedURLs.push({
                type: 'accommodation',
                name: 'üè† Airbnb - Unterk√ºnfte',
                shortName: 'Airbnb',
                url: airbnbURL,
                colorClass: 'green'
            });

            // 4. Kiwi Cars
            const puDate = fromDate;
            const doDate = toDate;
            const kiwiCarsURL = `https://cars.kiwi.com/search-results?preflang=de&locationName=${dest.name}&dropLocationName=${dest.name}&coordinates=${dest.lat}%2C${dest.lon}&dropCoordinates=${dest.lat}%2C${dest.lon}&driversAge=${driverAge}&puDay=${puDate.getDate()}&puMonth=${puDate.getMonth() + 1}&puYear=${puDate.getFullYear()}&puMinute=0&puHour=10&doDay=${doDate.getDate()}&doMonth=${doDate.getMonth() + 1}&doYear=${doDate.getFullYear()}&doMinute=0&doHour=10&ftsType=C&dropFtsType=C`;
            generatedURLs.push({
                type: 'car',
                name: 'üöó Kiwi Cars - Mietwagen',
                shortName: 'Mietwagen',
                url: kiwiCarsURL,
                colorClass: 'yellow'
            });

            // 5. Google - Ausw√§rtiges Amt Reisewarnung
            const aaSearchQuery = encodeURIComponent(`ausw√§rtiges amt reisehinweise ${dest.countryDE}`);
            const aaURL = `https://www.google.de/search?q=${aaSearchQuery}`;
            generatedURLs.push({
                type: 'info',
                name: '‚ö†Ô∏è Ausw√§rtiges Amt - Reisehinweise',
                shortName: 'Reisehinweise',
                url: aaURL,
                colorClass: 'red'
            });

            // 6. Google - Wetter.de Reisewetter
            const wetterSearchQuery = encodeURIComponent(`wetter.de reisewetter ${dest.name} ${dest.countryDE}`);
            const wetterURL = `https://www.google.de/search?q=${wetterSearchQuery}`;
            generatedURLs.push({
                type: 'info',
                name: 'üå§Ô∏è Wetter.de - Reisewetter',
                shortName: 'Wetter',
                url: wetterURL,
                colorClass: 'red'
            });

            // Output anzeigen
            displayURLs(dest, fromDate, toDate);
        }

        function displayURLs(dest, fromDate, toDate) {
            const days = Math.ceil((toDate - fromDate) / (1000 * 60 * 60 * 24));
            const adults = document.getElementById('adults').value;

            document.getElementById('summaryInfo').innerHTML = `
                <strong>üìç ${dest.name}, ${dest.country}</strong><br>
                üìÖ ${formatDateDE(fromDate)} - ${formatDateDE(toDate)} (${days} Tage)<br>
                üë• ${adults} Reisende
            `;

            // Manuelle Link-Buttons generieren
            const linkButtons = document.getElementById('linkButtons');
            linkButtons.innerHTML = '';
            generatedURLs.forEach((item) => {
                const a = document.createElement('a');
                a.href = item.url;
                a.target = '_blank';
                a.rel = 'noopener noreferrer';
                a.textContent = item.shortName;
                if (item.colorClass) {
                    a.className = item.colorClass;
                }
                linkButtons.appendChild(a);
            });

            // URL-Liste generieren
            const urlList = document.getElementById('urlList');
            urlList.innerHTML = '';

            generatedURLs.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = `url-item ${item.type}`;
                div.innerHTML = `
                    <div class="url-content">
                        <h4>${item.name}</h4>
                        <a href="${item.url}" target="_blank" rel="noopener noreferrer">${item.url}</a>
                    </div>
                    <button class="btn-primary btn-open" onclick="openSingleTab(${index})">√ñffnen</button>
                `;
                urlList.appendChild(div);
            });

            document.getElementById('output').classList.add('visible');
            document.getElementById('btnOpenTabs').disabled = false;
            document.getElementById('btnOpenTabs').textContent = `üöÄ Alle Tabs √ñffnen (${generatedURLs.length} St√ºck)`;
            document.getElementById('btnCopy').disabled = false;
        }

        // Einzelnen Tab √∂ffnen
        function openSingleTab(index) {
            const item = generatedURLs[index];
            if (item) {
                window.open(item.url, '_blank', 'noopener,noreferrer');
            }
        }

        // Alle Tabs √∂ffnen - VERBESSERTE VERSION
        function openAllTabs() {
            if (generatedURLs.length === 0) {
                alert('Bitte zuerst URLs generieren!');
                return;
            }

            const statusDiv = document.getElementById('tabStatus');
            statusDiv.className = 'tab-status visible warning';
            statusDiv.innerHTML = `
                <strong>‚è≥ √ñffne ${generatedURLs.length} Tabs...</strong><br>
                Falls nicht alle Tabs √∂ffnen: Pop-up Blocker deaktivieren oder die Buttons oben einzeln klicken.
            `;

            let openedCount = 0;
            let blockedCount = 0;

            // Methode 1: Direkt alle √∂ffnen mit etwas Verz√∂gerung
            generatedURLs.forEach((item, index) => {
                setTimeout(() => {
                    try {
                        const newWindow = window.open(item.url, '_blank', 'noopener,noreferrer');
                        if (newWindow === null || typeof newWindow === 'undefined') {
                            blockedCount++;
                            console.log(`Tab ${index + 1} wurde blockiert: ${item.name}`);
                        } else {
                            openedCount++;
                            console.log(`Tab ${index + 1} ge√∂ffnet: ${item.name}`);
                        }
                    } catch (e) {
                        blockedCount++;
                        console.error(`Fehler bei Tab ${index + 1}:`, e);
                    }

                    // Nach dem letzten Tab Status aktualisieren
                    if (index === generatedURLs.length - 1) {
                        setTimeout(() => {
                            updateTabStatus(openedCount, blockedCount);
                        }, 500);
                    }
                }, index * 500); // 500ms Verz√∂gerung zwischen jedem Tab
            });
        }

        function updateTabStatus(opened, blocked) {
            const statusDiv = document.getElementById('tabStatus');
            
            if (blocked === 0) {
                statusDiv.className = 'tab-status visible success';
                statusDiv.innerHTML = `<strong>‚úÖ Alle ${opened} Tabs erfolgreich ge√∂ffnet!</strong>`;
            } else if (opened > 0) {
                statusDiv.className = 'tab-status visible warning';
                statusDiv.innerHTML = `
                    <strong>‚ö†Ô∏è ${opened} von ${opened + blocked} Tabs ge√∂ffnet.</strong><br>
                    ${blocked} Tab(s) wurden vom Pop-up Blocker blockiert.<br>
                    <strong>L√∂sung:</strong> Nutze die farbigen Buttons oben um die restlichen Tabs einzeln zu √∂ffnen.
                `;
            } else {
                statusDiv.className = 'tab-status visible warning';
                statusDiv.innerHTML = `
                    <strong>‚ùå Pop-up Blocker aktiv!</strong><br>
                    Alle Tabs wurden blockiert.<br>
                    <strong>L√∂sung 1:</strong> Erlaube Pop-ups f√ºr diese Seite in deinem Browser.<br>
                    <strong>L√∂sung 2:</strong> Nutze die farbigen Buttons oben um die Tabs einzeln zu √∂ffnen.
                `;
            }
        }

        function copyAllURLs() {
            if (generatedURLs.length === 0) {
                alert('Bitte zuerst URLs generieren!');
                return;
            }

            const text = generatedURLs.map(item => `${item.name}\n${item.url}`).join('\n\n');
            
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ URLs wurden in die Zwischenablage kopiert!');
            }).catch(err => {
                // Fallback f√ºr √§ltere Browser
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ URLs wurden in die Zwischenablage kopiert!');
            });
        }
    </script>
</body>
</html>
